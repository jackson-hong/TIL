# 5/11 System Design - 키-값 저장소 설계

Date: May 11, 2022 10:44 PM

### Key-Value Store

- 비관계형 데이터베이스로 고유 식별자를 키로 가져야 한다
- 성능상 키는 짧을수록 좋다
- 널리알려진 memcached, redis 가 있다

### 설계 시작 ! - 문제 이해 및 설계 범위 확정

- 설계해야 할 조건
    - 키-값 쌍의 크기는 10KB 이하
    - 큰 데이터 저장 가능
    - 높은 가용성
    - 높은 규모 확장성
    - 데이터 일관성 수준 조정 가능
    - 응답 지연시간이 짧아야함

### 단일 서버 키값 저장소

- 한 대 서버만 사용하는 저장소 설계는 쉽다. 키-값 쌍 전부를 메모리에 해시 테이블로 저장하는 것
- 모든 데이터를 메모리에 두는 것은 불가능 할 수 있다
    - 개선책 - 데이터 압축, 자주 쓰이는 데이터만 메모리에 두고 나머지 디스크에 저장
- 그러나 한 대로 부족한 시기가 온다!

### 분산 키값 저장소

- 분산 키값 저장소는 분산 해시 테이블이라고도 불린다.

### CAP 정리

- 일관성 - Consistency, 가용성 - availability, 파티션 감내 - partition tolerance라는 세가지 요구사항을 동시에 만족하는 분산 시스템을 설계하는 것은 불가능하다는 정리
- 일관성
    
    : 분산 시스템에 접속하는 모든 클라이언트는 어떤 노드든 같은 데이터를 보게 되어야 함
    
- 가용성
    
    : 노드에 장애가 발생하여도 응답을 받을 수 있어야 한다.
    
- 파티션 감내
    
    : 파티션은 두 노드 사이에 통신 장애가 발생하였음을 의미, 네트워크에 파티션이 생겨도 시스템은 계속 동작하여야 함
    
- CAP 정리는 세가지 중 두가지를 충족하려면 나머지 하나는 반드시 희생되어야 하는 것을 의미
- CP, AP는 존재할 수 있으나 CA는 실세계에 존재하지 않는다. - 네트워크 장애는 피할 수 없는 일이므로
- 분산 시스템은 파티션 문제를 피할 수 없다.