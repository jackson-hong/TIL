# 3/17 Effective Java

Date: March 17, 2022 5:33 AM

### 인터페이스는 구현하는 쪽을 생각해 설계하라

- 자바 8 전에는 기존 구현체를 깨뜨리지 않고 인터페이스에 메서드를 추가할 수 없었으나 디폴트 메서드를 통해 가능하게 되었다.
- 그러나 모든 상황에서 불변식을 해치지 않는 디폴트 메서드를 작성하긴 어렵다.
- 예를 들어 자바 8의 Collection 인터페이스에 많은 디폴트 메서드들이 추가 되었으나 기존에 외부에서 Collection API를 사용해서 만든어진 라이브러리의 경우 새로 만들어진 디폴트 메서드를 재정의하고 있지 않아 예기치 못한 결과가 발생할 수 있다.
- 디폴트 메서드를 컴파일에는 성공하더라도 기존 구현체에 런타임 오류를 일으킬 수 있다.
- 그러므로 디폴트 메서드라는 도구를 사용하더라도 인터페이스를 설계할 때는 여전히 세심한 주의가 필요하다.

### 멤버 클래스는 되도록 Static으로 만들라

- 중첩 클래스(nsted class)
    - 자신을 감싼 바깥 클래스에서만 쓰여야 한다
    - 정적 멤버 클래스, 멤버 클래스, 익명 클래스, 지역 클래스 이렇게 네 가지가 존재한다.
    - 정적 멤버 클래스 외에는 전부 inner class에 해당한다
- 비정적 클래스의 경우 바깥 클래스와 암묵적으로 연결된다.
- 이러한 관계 정보가 비정적 멤버 클래스의 인스턴스 안에 메모리 공간을 차지하며, 생성 시간도 더 걸린다.
- 심지어 이러한 참조로 인해 바깥 클래스의 인스턴스를 GC가 수거하지 못하는 경우가 생길 수 있다.
- 중첩 클래스의 인스턴스가 바깥 인스턴스와 독립적으로 존재할 수 있다면 정적 멤버 클래스로 만들어야 한다.
- **멤버 클래스에서 바깥 인스턴스에 접근할 일이 없다면 무조건 static을 붙여서 정적 멤버 클래스로 만들자**
- 정리

> 메서드 밖에서도 사용해야 하거나 메서드 안에 정의하기엔 너무 길다면 멤버 클래스로 만든다. 멤버 클래스의 인스턴스 각각이 바깥 인스턴스를 참조한다면 비정적으로, 그렇지 않다면 정적으로 만들자. 중첩 클래스가 한 메서드 안에서만 쓰이면서 그 인스턴스를 생성하는 지점이 단 한곳이고 해당 타입으로 쓰기에 적합한 클래스나 인터페이스가 이미 있다면 익명 클래스로 만들고, 그렇지 않다면 지역 클래스로 만들자.
>